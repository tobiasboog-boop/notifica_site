---
layout: false
title: SSH-verbinding configureren - Notifica
permalink: /admin/tools/ssh-verbinding-uitleg/
robots: noindex, nofollow
---
<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSH-verbinding configureren - Notifica</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #16136F;
            --primary-light: #3636A2;
            --primary-pale: #e8eaff;
            --success: #16a34a;
            --success-pale: #dcfce7;
            --warning: #f59e0b;
            --warning-pale: #fef3c7;
            --danger: #dc2626;
            --danger-pale: #fee2e2;
            --info: #0284c7;
            --info-pale: #e0f2fe;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-900: #111827;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            color: var(--gray-700);
            background: var(--gray-50);
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            padding: 2rem;
            box-shadow: 0 4px 20px rgba(22, 19, 111, 0.15);
        }

        .header-content {
            max-width: 1100px;
            margin: 0 auto;
            text-align: center;
        }

        .header h1 {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .header p {
            font-size: 1rem;
            opacity: 0.9;
        }

        /* Navigation */
        .page-nav {
            background: white;
            border-bottom: 1px solid var(--gray-200);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .page-nav-content {
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 24px;
            display: flex;
            gap: 8px;
            overflow-x: auto;
        }

        .page-nav a {
            padding: 16px 20px;
            color: var(--gray-600);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            white-space: nowrap;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }

        .page-nav a:hover {
            color: var(--primary);
        }

        .page-nav a.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        /* Main Container */
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 48px 24px 80px;
        }

        /* Hero Section */
        .hero {
            text-align: center;
            margin-bottom: 56px;
        }

        .hero h2 {
            font-size: 2.25rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 16px;
            line-height: 1.2;
        }

        .hero .subtitle {
            font-size: 1.125rem;
            color: var(--gray-600);
            max-width: 680px;
            margin: 0 auto;
        }

        /* Content Sections */
        .content-section {
            background: white;
            border-radius: 16px;
            padding: 40px;
            margin-bottom: 32px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05), 0 4px 12px rgba(0, 0, 0, 0.03);
        }

        .content-section h3 {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .content-section h3 .icon {
            font-size: 1.75rem;
        }

        .content-section h4 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--gray-900);
            margin: 28px 0 12px 0;
        }

        .content-section p {
            margin-bottom: 16px;
            font-size: 1rem;
            color: var(--gray-600);
        }

        .content-section p:last-child {
            margin-bottom: 0;
        }

        /* Problem/Solution Cards */
        .problem-solution {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin: 24px 0;
        }

        @media (max-width: 640px) {
            .problem-solution {
                grid-template-columns: 1fr;
            }
        }

        .problem-card, .solution-card {
            padding: 24px;
            border-radius: 12px;
        }

        .problem-card {
            background: var(--danger-pale);
            border: 1px solid #fecaca;
        }

        .problem-card h4 {
            color: var(--danger);
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin: 0 0 12px 0;
        }

        .solution-card {
            background: var(--success-pale);
            border: 1px solid #bbf7d0;
        }

        .solution-card h4 {
            color: var(--success);
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin: 0 0 12px 0;
        }

        .problem-card p, .solution-card p {
            font-size: 0.95rem;
            margin: 0;
        }

        .problem-card p {
            color: #991b1b;
        }

        .solution-card p {
            color: #166534;
        }

        /* Benefit Cards */
        .benefits-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 24px;
        }

        @media (max-width: 768px) {
            .benefits-grid {
                grid-template-columns: 1fr;
            }
        }

        .benefit-card {
            background: var(--gray-50);
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            border: 1px solid var(--gray-200);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .benefit-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
        }

        .benefit-card .icon {
            font-size: 2.5rem;
            margin-bottom: 12px;
        }

        .benefit-card h4 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--gray-900);
            margin: 0 0 8px 0;
        }

        .benefit-card p {
            font-size: 0.875rem;
            color: var(--gray-500);
            margin: 0;
        }

        /* Visual Diagram */
        .diagram-container {
            background: var(--primary-pale);
            border-radius: 12px;
            padding: 32px;
            margin: 24px 0;
        }

        .diagram {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 16px;
            flex-wrap: wrap;
        }

        .diagram-box {
            background: white;
            border-radius: 12px;
            padding: 20px 24px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(22, 19, 111, 0.1);
            min-width: 140px;
        }

        .diagram-box .icon {
            font-size: 2rem;
            margin-bottom: 8px;
        }

        .diagram-box .label {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--gray-900);
        }

        .diagram-box .sublabel {
            font-size: 0.75rem;
            color: var(--gray-500);
            margin-top: 2px;
        }

        .diagram-arrow {
            font-size: 1.5rem;
            color: var(--primary);
        }

        .diagram-tunnel {
            background: var(--primary);
            color: white;
            border-radius: 8px;
            padding: 12px 24px;
            text-align: center;
        }

        .diagram-tunnel .icon {
            font-size: 1.25rem;
        }

        .diagram-tunnel .label {
            font-size: 0.75rem;
            font-weight: 600;
            margin-top: 4px;
        }

        /* Security List */
        .security-list {
            list-style: none;
            margin: 20px 0;
        }

        .security-list li {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid var(--gray-100);
        }

        .security-list li:last-child {
            border-bottom: none;
        }

        .security-list .check {
            color: var(--success);
            font-size: 1.25rem;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .security-list .text {
            flex: 1;
        }

        .security-list .text strong {
            display: block;
            color: var(--gray-900);
            font-weight: 600;
            margin-bottom: 2px;
        }

        .security-list .text span {
            font-size: 0.9rem;
            color: var(--gray-500);
        }

        /* FAQ Section */
        .faq-item {
            border-bottom: 1px solid var(--gray-200);
            padding: 20px 0;
        }

        .faq-item:first-child {
            padding-top: 0;
        }

        .faq-item:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .faq-item h4 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--gray-900);
            margin: 0 0 8px 0;
        }

        .faq-item p {
            font-size: 0.95rem;
            color: var(--gray-600);
            margin: 0;
        }

        /* Info Box */
        .info-box {
            background: var(--info-pale);
            border: 1px solid #7dd3fc;
            border-radius: 12px;
            padding: 20px 24px;
            margin: 24px 0;
            display: flex;
            gap: 16px;
            align-items: flex-start;
        }

        .info-box .icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .info-box .text {
            flex: 1;
        }

        .info-box .text strong {
            display: block;
            color: #0369a1;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .info-box .text p {
            font-size: 0.9rem;
            color: #0369a1;
            margin: 0;
        }

        /* Warning Box */
        .warning-box {
            background: var(--warning-pale);
            border: 1px solid #fcd34d;
            border-radius: 12px;
            padding: 20px 24px;
            margin: 24px 0;
        }

        .warning-box strong {
            color: #92400e;
            font-weight: 600;
        }

        .warning-box p {
            font-size: 0.9rem;
            color: #92400e;
            margin: 0;
        }

        /* Code Block */
        .code-block {
            background: #1e293b;
            border-radius: 8px;
            padding: 16px 20px;
            margin: 16px 0;
            overflow-x: auto;
            font-family: 'SF Mono', 'Consolas', 'Monaco', monospace;
            font-size: 0.85rem;
            color: #e2e8f0;
            line-height: 1.6;
            white-space: pre;
        }

        /* Step Block */
        .step-block {
            margin-bottom: 32px;
            padding-bottom: 32px;
            border-bottom: 1px solid var(--gray-200);
        }

        .step-block:last-of-type {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .step-block h4 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--gray-900);
            margin: 0 0 12px 0;
        }

        .step-block p {
            margin: 8px 0;
        }

        .step-block ol {
            margin: 12px 0;
            padding-left: 20px;
            color: var(--gray-600);
        }

        .step-block ol li {
            margin-bottom: 6px;
            font-size: 0.95rem;
        }

        /* Checkbox Group */
        .checkbox-group {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 16px;
            background: var(--gray-50);
            border: 1px solid var(--gray-200);
            border-radius: 8px;
            margin: 16px 0;
        }

        .checkbox-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-top: 2px;
            flex-shrink: 0;
            accent-color: var(--primary);
            cursor: pointer;
        }

        .checkbox-group label {
            font-size: 0.95rem;
            color: var(--gray-700);
            cursor: pointer;
            line-height: 1.5;
        }

        /* Expandable Details */
        .install-details {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: 8px;
            margin: 12px 0;
        }

        .install-details summary {
            padding: 14px 16px;
            cursor: pointer;
            font-weight: 500;
            color: var(--gray-700);
            list-style: none;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 0.95rem;
        }

        .install-details summary::-webkit-details-marker {
            display: none;
        }

        .install-details summary::after {
            content: "+";
            font-size: 1.25rem;
            font-weight: 400;
            color: var(--gray-500);
        }

        .install-details[open] summary::after {
            content: "‚àí";
        }

        .install-details[open] summary {
            border-bottom: 1px solid var(--gray-200);
        }

        .install-details .details-content {
            padding: 16px;
            font-size: 0.95rem;
            background: var(--gray-50);
        }

        .install-details .details-content p {
            margin: 0 0 12px 0;
        }

        .install-details .details-content ol {
            margin: 12px 0;
            padding-left: 20px;
        }

        /* Form styles */
        .form-section {
            background: white;
            border-radius: 16px;
            padding: 40px;
            margin-bottom: 32px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05), 0 4px 12px rgba(0, 0, 0, 0.03);
            border-top: 3px solid var(--primary);
        }

        .form-section h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--gray-200);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: 500;
            margin-bottom: 8px;
            color: var(--gray-700);
            font-size: 0.95rem;
        }

        .form-group label.required::after {
            content: " *";
            color: var(--danger);
        }

        .form-group input[type="text"],
        .form-group input[type="email"],
        .form-group input[type="tel"],
        .form-group input[type="password"],
        .form-group input[type="number"],
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 14px;
            border: 1px solid var(--gray-300);
            border-radius: 8px;
            font-size: 0.95rem;
            font-family: inherit;
            transition: border-color 0.2s, box-shadow 0.2s;
            background: white;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(22, 19, 111, 0.1);
        }

        .form-group .hint {
            font-size: 0.85rem;
            color: var(--gray-500);
            margin-top: 6px;
        }

        .form-group textarea {
            font-family: 'SF Mono', 'Consolas', monospace;
            font-size: 0.85rem;
            resize: vertical;
            min-height: 120px;
        }

        /* Buttons */
        .button-group {
            display: flex;
            gap: 12px;
            margin-top: 24px;
            flex-wrap: wrap;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 14px 28px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            text-decoration: none;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            font-family: inherit;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #0f0c4a;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--gray-500);
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background: var(--gray-600);
        }

        .btn:disabled {
            background: var(--gray-300);
            color: var(--gray-500);
            cursor: not-allowed;
            transform: none;
        }

        /* Test Results */
        #test-results {
            display: none;
            margin-top: 24px;
            background: var(--gray-50);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid var(--gray-200);
        }

        #test-results h4 {
            margin: 0 0 16px 0;
            font-size: 1rem;
            color: var(--gray-900);
        }

        .test-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 14px;
            background: white;
            margin-bottom: 8px;
            border-radius: 8px;
            border: 1px solid var(--gray-200);
            font-size: 0.95rem;
        }

        .test-item:last-child {
            margin-bottom: 0;
        }

        .test-icon {
            font-size: 1.25rem;
            width: 28px;
            text-align: center;
            flex-shrink: 0;
        }

        .test-icon.success { color: var(--success); }
        .test-icon.error { color: var(--danger); }
        .test-icon.warning { color: var(--warning); }
        .test-icon.pending { color: var(--gray-500); }

        .test-message {
            flex-grow: 1;
        }

        .test-detail {
            font-size: 0.85rem;
            color: var(--gray-500);
            margin-top: 4px;
        }

        /* Spinner */
        .spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid var(--gray-200);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.7s linear infinite;
            margin-right: 8px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* PowerShell validation */
        .ps-validation {
            margin: 16px 0;
            padding: 16px;
            border-radius: 8px;
            font-size: 0.9rem;
        }

        .ps-validation.success {
            background: var(--success-pale);
            border: 1px solid #bbf7d0;
        }

        .ps-validation.warning {
            background: var(--warning-pale);
            border: 1px solid #fcd34d;
        }

        .ps-validation.error {
            background: var(--danger-pale);
            border: 1px solid #fecaca;
        }

        .ps-validation h4 {
            margin: 0 0 8px 0;
            font-size: 0.95rem;
            font-weight: 600;
        }

        .ps-validation ul {
            margin: 0;
            padding-left: 20px;
        }

        .ps-validation li {
            font-size: 0.85rem;
            margin-bottom: 4px;
        }

        .ps-ok { color: var(--success); }
        .ps-fout { color: var(--danger); }
        .ps-warn { color: var(--warning); }

        /* Conditional fields */
        .conditional-field {
            display: none;
        }

        .conditional-field.visible {
            display: block;
        }

        /* Success message */
        .success-msg {
            background: var(--success-pale) !important;
            border-color: #bbf7d0 !important;
        }

        /* Responsive */
        @media (max-width: 640px) {
            .container {
                padding: 32px 16px 64px;
            }

            .content-section,
            .form-section {
                padding: 24px 20px;
            }

            .hero h2 {
                font-size: 1.75rem;
            }

            .diagram {
                flex-direction: column;
            }

            .diagram-arrow {
                transform: rotate(90deg);
            }

            .button-group {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <h1>SSH-verbinding configureren voor Syntess</h1>
            <p>Beveiligde toegang tot uw Firebird database voor realtime dashboards</p>
        </div>
    </header>

    <nav class="page-nav">
        <div class="page-nav-content">
            <a href="#waarom" class="active">Waarom SSH?</a>
            <a href="#beveiliging">Beveiliging</a>
            <a href="#configuratie">Configuratie</a>
            <a href="#formulier">Gegevens & Test</a>
            <a href="#faq">Veelgestelde vragen</a>
        </div>
    </nav>

    <main class="container">
        <!-- Waarom SSH -->
        <section id="waarom" class="content-section">
            <h3><span class="icon">üéØ</span> Waarom hebben we een SSH-verbinding nodig?</h3>
            <p>
                Notifica bouwt Power BI dashboards die u realtime inzicht geven in uw bedrijfsprestaties: omzet, projecten, voorraad, uren en meer. Deze dashboards tonen actuele data uit uw Syntess-systeem.
            </p>
            <p>
                Om dit mogelijk te maken, moet ons systeem <strong>beveiligd toegang</strong> krijgen tot uw Firebird database. We halen alleen de benodigde data op - we schrijven nooit naar uw database.
            </p>

            <div class="problem-solution">
                <div class="problem-card">
                    <h4>Zonder veilige verbinding</h4>
                    <p>
                        Directe databaseverbindingen via internet zijn kwetsbaar voor afluisteren en aanvallen. Gevoelige bedrijfsdata zou onderschept kunnen worden.
                    </p>
                </div>
                <div class="solution-card">
                    <h4>Met SSH-tunnel</h4>
                    <p>
                        Alle data wordt versleuteld verzonden via een beveiligde tunnel. Alleen Notifica kan verbinding maken, en alleen lezen is toegestaan.
                    </p>
                </div>
            </div>

            <div class="diagram-container">
                <div class="diagram">
                    <div class="diagram-box">
                        <div class="icon">üè¢</div>
                        <div class="label">Notifica</div>
                        <div class="sublabel">Power BI systeem</div>
                    </div>
                    <div class="diagram-arrow">‚Üí</div>
                    <div class="diagram-tunnel">
                        <div class="icon">üîí</div>
                        <div class="label">SSH-tunnel (versleuteld)</div>
                    </div>
                    <div class="diagram-arrow">‚Üí</div>
                    <div class="diagram-box">
                        <div class="icon">üñ•Ô∏è</div>
                        <div class="label">Uw server</div>
                        <div class="sublabel">Syntess/Firebird</div>
                    </div>
                </div>
            </div>

            <div class="benefits-grid">
                <div class="benefit-card">
                    <div class="icon">üìä</div>
                    <h4>Realtime inzicht</h4>
                    <p>Dashboards tonen actuele data, geen verouderde exports</p>
                </div>
                <div class="benefit-card">
                    <div class="icon">‚ö°</div>
                    <h4>Automatisch bijgewerkt</h4>
                    <p>Data wordt automatisch opgehaald, geen handmatig werk</p>
                </div>
                <div class="benefit-card">
                    <div class="icon">üîí</div>
                    <h4>Maximale beveiliging</h4>
                    <p>Industriestandaard encryptie beschermt uw data</p>
                </div>
            </div>

            <div class="info-box">
                <div class="icon">üí°</div>
                <div class="text">
                    <strong>Eenmalige configuratie</strong>
                    <p>De SSH-verbinding hoeft slechts eenmaal te worden ingesteld. Daarna werkt alles automatisch en onderhouden wij de verbinding voor u.</p>
                </div>
            </div>
        </section>

        <!-- Beveiliging -->
        <section id="beveiliging" class="content-section">
            <h3><span class="icon">üîê</span> Hoe beveiligen we de verbinding?</h3>

            <h4>Firewall-regels & toegangsbeperkingen</h4>
            <ul class="security-list">
                <li>
                    <span class="check">‚úì</span>
                    <div class="text">
                        <strong>Alleen Notifica IP-adressen toegestaan</strong>
                        <span>De OpenSSH-server via poort 49222 is alleen toegankelijk vanaf onze specifieke IP-adressen</span>
                    </div>
                </li>
                <li>
                    <span class="check">‚úì</span>
                    <div class="text">
                        <strong>Authenticatie vereist</strong>
                        <span>De OpenSSH-server kan alleen met authenticatie gebruikt worden (SSH-account en wachtwoord)</span>
                    </div>
                </li>
                <li>
                    <span class="check">‚úì</span>
                    <div class="text">
                        <strong>Geen shell-toegang</strong>
                        <span>De SSH-gebruiker heeft alleen tunnel-toegang; geen shell- of bestandstoegang tot de server</span>
                    </div>
                </li>
                <li>
                    <span class="check">‚úì</span>
                    <div class="text">
                        <strong>Beperkte poortforward</strong>
                        <span>De SSH-gebruiker kan alleen een poortforward opzetten naar de interne Firebird-poort (standaard 3050)</span>
                    </div>
                </li>
            </ul>

            <h4>Database bescherming</h4>
            <ul class="security-list">
                <li>
                    <span class="check">‚úì</span>
                    <div class="text">
                        <strong>Geen directe databaseverbinding</strong>
                        <span>Er is geen directe databaseverbinding mogelijk, alles gaat via een versleutelde SSH-tunnel</span>
                    </div>
                </li>
                <li>
                    <span class="check">‚úì</span>
                    <div class="text">
                        <strong>Firebird alleen lokaal bereikbaar</strong>
                        <span>De Firebird-poort is alleen lokaal bereikbaar; niet vanaf het internet</span>
                    </div>
                </li>
                <li>
                    <span class="check">‚úì</span>
                    <div class="text">
                        <strong>Aparte database-authenticatie</strong>
                        <span>Verbinding met Firebird gebeurt met aparte authenticatie (Firebird-account en wachtwoord)</span>
                    </div>
                </li>
            </ul>

            <h4>Logging & monitoring</h4>
            <ul class="security-list">
                <li>
                    <span class="check">‚úì</span>
                    <div class="text">
                        <strong>SSH-verbindingen worden gelogd</strong>
                        <span>Om ongeautoriseerde toegang te detecteren</span>
                    </div>
                </li>
                <li>
                    <span class="check">‚úì</span>
                    <div class="text">
                        <strong>Automatische blokkering</strong>
                        <span>Onbekende IP-adressen worden automatisch geblokkeerd via firewall-instellingen</span>
                    </div>
                </li>
            </ul>
        </section>

        <!-- Configuratie Stappen -->
        <section id="configuratie" class="content-section">
            <h3><span class="icon">üìã</span> Configuratiestappen</h3>
            <p>Doorloop onderstaande stappen. De configuratie wordt uitgevoerd door uw systeembeheerder of IT-partner en duurt doorgaans 30-60 minuten.</p>

            <!-- Stap 1: Firewall -->
            <div class="step-block">
                <h4>Stap 1: Firewall configureren met whitelist</h4>
                <p>Sta TCP-poort 49222 toe in de firewall, maar <strong>uitsluitend</strong> voor de volgende IP-adressen:</p>
                <div class="code-block">87.106.209.107
85.215.150.12
85.215.208.169
85.215.176.135</div>
                <div class="checkbox-group">
                    <input type="checkbox" id="check-firewall" name="check-firewall">
                    <label for="check-firewall">Firewall geconfigureerd met whitelist voor bovenstaande IP-adressen</label>
                </div>
            </div>

            <!-- Stap 2: Port forwarding -->
            <div class="step-block">
                <h4>Stap 2: Port forwarding instellen</h4>
                <p>Stel op de router een port forward in van poort 49222 naar de server waar OpenSSH-server op ge√Ønstalleerd staat.</p>
                <div class="info-box">
                    <div class="icon">‚ÑπÔ∏è</div>
                    <div class="text">
                        <strong>Belangrijk</strong>
                        <p>Wij loggen extern in op poort 49222. Wij moeten dan direct uitkomen op de server waar OpenSSH draait.</p>
                    </div>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="check-portforward" name="check-portforward">
                    <label for="check-portforward">Port forwarding ingesteld: poort 49222 ‚Üí OpenSSH server</label>
                </div>
            </div>

            <!-- Stap 3: OpenSSH installeren -->
            <div class="step-block">
                <h4>Stap 3: OpenSSH Server installeren</h4>
                <p>OpenSSH Server is een standaard onderdeel van Windows Server, maar moet mogelijk nog worden geactiveerd.</p>

                <details class="install-details">
                    <summary>Windows Server 2019 en nieuwer</summary>
                    <div class="details-content">
                        <p><strong>Via Server Manager (GUI):</strong></p>
                        <ol>
                            <li>Open Server Manager ‚Üí Manage ‚Üí Add Roles and Features</li>
                            <li>Klik door naar "Features"</li>
                            <li>Vink aan: OpenSSH Server</li>
                            <li>Installeer en herstart indien nodig</li>
                        </ol>
                        <p><strong>Via PowerShell:</strong></p>
                        <div class="code-block">Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0
Start-Service sshd
Set-Service -Name sshd -StartupType Automatic</div>
                    </div>
                </details>

                <details class="install-details">
                    <summary>Windows Server 2016 en ouder</summary>
                    <div class="details-content">
                        <p>Download OpenSSH voor Windows:</p>
                        <ol>
                            <li>Ga naar <a href="https://github.com/PowerShell/Win32-OpenSSH/releases" target="_blank" style="color: var(--primary);">github.com/PowerShell/Win32-OpenSSH/releases</a></li>
                            <li>Download <code>OpenSSH-Win64.zip</code></li>
                            <li>Pak uit naar <code>C:\Program Files\OpenSSH</code></li>
                            <li>Open PowerShell als Administrator en voer uit:</li>
                        </ol>
                        <div class="code-block">cd "C:\Program Files\OpenSSH"
.\install-sshd.ps1
Start-Service sshd
Set-Service -Name sshd -StartupType Automatic</div>
                    </div>
                </details>

                <div class="info-box">
                    <div class="icon">üí°</div>
                    <div class="text">
                        <strong>Aanbeveling</strong>
                        <p>Installeer OpenSSH bij voorkeur op de server waarop Syntess/Firebird actief is, zodat u direct op de juiste server bent. Dit is echter niet verplicht (zie "jump server").</p>
                    </div>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="check-openssh" name="check-openssh">
                    <label for="check-openssh">OpenSSH Server ge√Ønstalleerd en gestart</label>
                </div>
            </div>

            <!-- Stap 4: Gebruiker aanmaken -->
            <div class="step-block">
                <h4>Stap 4: Gebruiker aanmaken</h4>
                <p>Maak op de OpenSSH-server een Windows-gebruiker aan met de gebruikersnaam <code>notifica</code>.</p>

                <details class="install-details">
                    <summary>Instructies gebruiker aanmaken</summary>
                    <div class="details-content">
                        <p><strong>Via GUI:</strong></p>
                        <ol>
                            <li>Druk op <code>Win + R</code>, typ <code>lusrmgr.msc</code>, druk Enter</li>
                            <li>Klik op <strong>Users</strong> in het linkerpaneel</li>
                            <li>Rechtsklik ‚Üí New User</li>
                            <li>Gebruikersnaam: <code>notifica</code></li>
                            <li>Wachtwoord instellen</li>
                            <li>Vinkje <strong>uit</strong> bij "User must change password at next logon"</li>
                            <li>Vinkje <strong>aan</strong> bij "Password never expires"</li>
                        </ol>
                        <p><strong>Via PowerShell:</strong></p>
                        <div class="code-block">$password = Read-Host -AsSecureString "Voer wachtwoord in"
New-LocalUser -Name "notifica" -Password $password -PasswordNeverExpires</div>
                    </div>
                </details>

                <div class="checkbox-group">
                    <input type="checkbox" id="check-user" name="check-user">
                    <label for="check-user">Gebruiker <code>notifica</code> aangemaakt met wachtwoord (verloopt niet)</label>
                </div>
            </div>

            <!-- Stap 5: Rechten op database map -->
            <div class="step-block">
                <h4>Stap 5: Rechten op database map (Firebird server)</h4>
                <p>Geef de gebruiker <code>notifica</code> <strong>leesrechten</strong> op de map op de Firebird server waarin de operationele Syntess Firebird-database staat (meestal <code>atrium.fdb</code>).</p>

                <details class="install-details">
                    <summary>Instructies rechten instellen</summary>
                    <div class="details-content">
                        <p><strong>Voer deze stappen uit op de Firebird server:</strong></p>
                        <ol>
                            <li>Navigeer naar de map waar de database staat (bijv. <code>E:\data\</code>)</li>
                            <li>Rechtsklik op de map ‚Üí Properties ‚Üí Security tab</li>
                            <li>Klik Edit ‚Üí Add</li>
                            <li>Typ <code>notifica</code> en klik Check Names ‚Üí OK</li>
                            <li>Geef minimaal <strong>Read</strong> rechten</li>
                            <li>Klik OK om op te slaan</li>
                        </ol>
                        <p><strong>Let op:</strong> Als OpenSSH op een jump server draait, moet de gebruiker <code>notifica</code> ook op de Firebird server bestaan met dezelfde credentials, √≥f u moet een domeingebruiker gebruiken.</p>
                    </div>
                </details>

                <div class="info-box">
                    <div class="icon">‚ÑπÔ∏è</div>
                    <div class="text">
                        <strong>Let op</strong>
                        <p>Het volledige pad naar de database (inclusief bestandsnaam) hebben wij nodig om de verbinding te kunnen maken.</p>
                    </div>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="check-rechten" name="check-rechten">
                    <label for="check-rechten">Gebruiker <code>notifica</code> heeft leesrechten op de database map</label>
                </div>
            </div>

            <!-- Stap 6: SSH configuratie -->
            <div class="step-block">
                <h4>Stap 6: SSH configuratie aanpassen</h4>
                <p>Open het configuratiebestand:</p>
                <div class="code-block">notepad "C:\ProgramData\ssh\sshd_config"</div>

                <p><strong>Pas de volgende instellingen aan.</strong> Deze instellingen staan vaak al in het bestand maar zijn uitgeschakeld met een <code>#</code> ervoor. Zoek de bestaande regel op en verwijder de <code>#</code>. Als de instelling niet bestaat, voeg deze dan toe.</p>

                <p>Het <code>Match</code>-blok moet als geheel <strong>onderaan het bestand</strong> worden toegevoegd:</p>

                <div class="code-block">Port 49222
PasswordAuthentication yes
ChallengeResponseAuthentication no
PermitEmptyPasswords no
TCPKeepAlive yes
AllowTcpForwarding local
PermitOpen localhost:&lt;FIREBIRD_POORT&gt;

Match User notifica
	ForceCommand cmd /c "echo Geen shell toegang toegestaan && exit"
	PermitTTY no
	X11Forwarding no
	AllowAgentForwarding no</div>

                <div class="warning-box">
                    <p><strong>Let op bij <code>PermitOpen</code>:</strong></p>
                    <p>‚Ä¢ <strong>OpenSSH op de Firebird-server:</strong> gebruik <code>PermitOpen localhost:&lt;FIREBIRD_POORT&gt;</code></p>
                    <p>‚Ä¢ <strong>OpenSSH op een jump server:</strong> gebruik <code>PermitOpen &lt;INTERN_IP_FIREBIRD_SERVER&gt;:&lt;FIREBIRD_POORT&gt;</code></p>
                    <p style="margin-top: 8px;">De standaard Firebird-poort is <strong>3050</strong>, maar kan per installatie afwijken.</p>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="check-sshconfig" name="check-sshconfig">
                    <label for="check-sshconfig">SSH configuratie aangepast volgens bovenstaande instellingen</label>
                </div>
            </div>

            <!-- Stap 7: Service herstarten -->
            <div class="step-block">
                <h4>Stap 7: SSH service herstarten</h4>
                <p>Na het aanpassen van de configuratie moet de SSH service herstart worden.</p>

                <p><strong>Via PowerShell:</strong></p>
                <div class="code-block">Restart-Service sshd</div>

                <p><strong>Via Windows Services:</strong></p>
                <ol>
                    <li>Druk op <code>Win + R</code>, typ <code>services.msc</code>, druk Enter</li>
                    <li>Zoek de service <strong>OpenSSH SSH Server</strong></li>
                    <li>Rechtsklik ‚Üí Herstarten</li>
                </ol>

                <div class="checkbox-group">
                    <input type="checkbox" id="check-restart" name="check-restart">
                    <label for="check-restart">SSH service herstart na configuratie</label>
                </div>
            </div>

            <div class="info-box">
                <div class="icon">üì•</div>
                <div class="text">
                    <strong>PowerShell testscript</strong>
                    <p>Download het <a href="https://notifica.nl/wp-content/uploads/2026/01/Test-SSHConfiguratie.txt" download="Test-SSHConfiguratie.ps1" style="color: #0369a1; font-weight: 500;">PowerShell testscript</a> en voer dit uit op de server om de lokale configuratie te controleren voordat u de gegevens hieronder invult.</p>
                </div>
            </div>
        </section>

        <!-- Formulier -->
        <section id="formulier">
            <form id="ssh-config-form">
                <!-- Hidden fields -->
                <input type="hidden" id="klantnummer" name="klantnummer" value="">
                <input type="hidden" id="referentie" name="referentie" value="">
                <input type="hidden" id="kaarttitel" name="kaarttitel" value="">
                <input type="hidden" id="cardid" name="cardid" value="">

                <!-- Contactgegevens -->
                <div class="form-section">
                    <h3>Contactgegevens</h3>

                    <div class="form-group">
                        <label for="klantnaam" class="required">Naam van gezamenlijke klant</label>
                        <input type="text" id="klantnaam" name="klantnaam" required>
                    </div>

                    <div class="form-group">
                        <label for="bedrijfsnaam" class="required">Uw bedrijfsnaam</label>
                        <input type="text" id="bedrijfsnaam" name="bedrijfsnaam" required>
                    </div>

                    <div class="form-group">
                        <label for="contactpersoon" class="required">Uw naam</label>
                        <input type="text" id="contactpersoon" name="contactpersoon" required>
                    </div>

                    <div class="form-group">
                        <label for="email" class="required">E-mailadres</label>
                        <input type="email" id="email" name="email" required>
                    </div>

                    <div class="form-group">
                        <label for="telefoon" class="required">Telefoonnummer</label>
                        <input type="tel" id="telefoon" name="telefoon" required>
                    </div>
                </div>

                <!-- Server configuratie -->
                <div class="form-section">
                    <h3>Server configuratie</h3>

                    <div class="form-group">
                        <label for="server-type" class="required">Type installatie</label>
                        <select id="server-type" name="server-type" required>
                            <option value="">Selecteer...</option>
                            <option value="direct">OpenSSH op de Firebird/Syntess server</option>
                            <option value="jumpserver">OpenSSH op een jump server</option>
                        </select>
                        <div class="hint">Bij een jump server draait OpenSSH op een andere server dan de Firebird database.</div>
                    </div>

                    <div class="form-group">
                        <label for="extern-ip" class="required">Extern IP-adres</label>
                        <input type="text" id="extern-ip" name="extern-ip" required
                               pattern="^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$"
                               placeholder="bijv. 203.0.113.50">
                        <div class="hint">Het publieke IP-adres waarop wij uw netwerk kunnen bereiken.</div>
                    </div>

                    <div class="form-group conditional-field" id="intern-ip-group">
                        <label for="intern-ip" class="required">Intern IP-adres Firebird server</label>
                        <input type="text" id="intern-ip" name="intern-ip"
                               pattern="^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$"
                               placeholder="bijv. 192.168.1.100">
                        <div class="hint">Het interne IP-adres van de Firebird server (alleen bij jump server).</div>
                    </div>

                    <div class="form-group">
                        <label for="firebird-poort" class="required">Firebird poort</label>
                        <input type="number" id="firebird-poort" name="firebird-poort" value="3050" required min="1" max="65535">
                        <div class="hint">Standaard is 3050. Controleer firebird.conf bij afwijkende poort.</div>
                    </div>

                    <div class="form-group">
                        <label for="database-pad" class="required">Database pad</label>
                        <input type="text" id="database-pad" name="database-pad" required
                               placeholder="bijv. E:\data\atrium.fdb">
                        <div class="hint">Het volledige pad naar de Firebird database op de server.</div>
                    </div>
                </div>

                <!-- PowerShell output -->
                <div class="form-section">
                    <h3>PowerShell testresultaat</h3>

                    <div class="form-group">
                        <label for="powershell-output" class="required">Plak hier de output van het PowerShell testscript</label>
                        <textarea id="powershell-output" name="powershell-output" rows="10" required
                            placeholder="Plak hier de volledige output van Test-SSHConfiguratie.ps1..."></textarea>
                        <div class="hint">De output begint met "SSH Configuratie Test - Notifica Firebird-koppeling"</div>
                    </div>

                    <div id="ps-validation" class="ps-validation" style="display: none;">
                        <div id="ps-validation-content"></div>
                    </div>
                </div>

                <!-- Inloggegevens -->
                <div class="form-section">
                    <h3>Inloggegevens</h3>

                    <div class="warning-box">
                        <p><strong>Let op:</strong> Deze gegevens worden versleuteld verzonden (HTTPS) en niet opgeslagen. Ze worden alleen gebruikt voor de configuratietest en doorgestuurd naar Notifica.</p>
                    </div>

                    <div class="form-group">
                        <label for="ssh-wachtwoord" class="required">SSH wachtwoord (gebruiker: notifica)</label>
                        <input type="password" id="ssh-wachtwoord" name="ssh-wachtwoord" required>
                    </div>

                    <div class="form-group">
                        <label for="db-gebruiker" class="required">Database gebruiker</label>
                        <input type="text" id="db-gebruiker" name="db-gebruiker" value="atrium" required>
                        <div class="hint">Standaard: atrium</div>
                    </div>

                    <div class="form-group">
                        <label for="db-wachtwoord" class="required">Database wachtwoord</label>
                        <input type="password" id="db-wachtwoord" name="db-wachtwoord" required>
                        <div class="hint">Standaard: syntess (wijzigen aanbevolen)</div>
                    </div>
                </div>

                <!-- Test en verstuur -->
                <div class="form-section">
                    <h3>Test en verstuur</h3>

                    <p>Klik op "Test configuratie" om te controleren of alles correct is ingesteld. Na een succesvolle test kunt u het formulier versturen.</p>

                    <div class="button-group">
                        <button type="button" id="btn-test" class="btn btn-secondary" onclick="runTest()">
                            üîç Test configuratie
                        </button>
                        <button type="submit" id="btn-submit" class="btn btn-primary" disabled title="Voer eerst een succesvolle test uit">
                            üì§ Verstuur formulier
                        </button>
                    </div>

                    <div id="test-required-msg" class="info-box" style="margin-top: 20px;">
                        <div class="icon">‚ÑπÔ∏è</div>
                        <div class="text">
                            <strong>Let op</strong>
                            <p>Voer eerst een succesvolle configuratietest uit voordat u het formulier kunt versturen.</p>
                        </div>
                    </div>

                    <div id="test-results">
                        <h4>Testresultaten</h4>
                        <div id="test-items"></div>
                    </div>
                </div>
            </form>
        </section>

        <!-- Veelgestelde vragen -->
        <section id="faq" class="content-section">
            <h3><span class="icon">‚ùì</span> Veelgestelde vragen</h3>

            <div class="faq-item">
                <h4>Is dit veilig voor mijn bedrijfsdata?</h4>
                <p>
                    Ja. SSH is de industriestandaard voor beveiligde verbindingen en wordt wereldwijd gebruikt door banken, overheden en grote bedrijven. De configuratie die wij gebruiken beperkt de toegang tot alleen lezen van de database - niets meer.
                </p>
            </div>

            <div class="faq-item">
                <h4>Kan Notifica wijzigingen maken in mijn Syntess?</h4>
                <p>
                    Nee. De SSH-gebruiker heeft alleen leesrechten op de database. Bovendien zijn Firebird-logins (waarmee je daadwerkelijk data kunt wijzigen) apart beveiligd. Wij kunnen uw data alleen lezen, nooit wijzigen.
                </p>
            </div>

            <div class="faq-item">
                <h4>Wat als mijn server herstart?</h4>
                <p>
                    De SSH-service is geconfigureerd om automatisch te starten bij het opstarten van Windows. Na een herstart is de verbinding direct weer beschikbaar.
                </p>
            </div>

            <div class="faq-item">
                <h4>Heeft dit impact op de performance van Syntess?</h4>
                <p>
                    Minimaal. We halen data op in batches tijdens daluren en cachen de resultaten. De belasting op uw server is vergelijkbaar met een extra gebruiker die af en toe een rapport opvraagt.
                </p>
            </div>

            <div class="faq-item">
                <h4>Wie kan de verbinding maken?</h4>
                <p>
                    Alleen onze specifieke IP-adressen zijn toegestaan in uw firewall. Zelfs als iemand het wachtwoord zou kennen, kan er geen verbinding worden gemaakt vanaf een ander IP-adres.
                </p>
            </div>
        </section>
    </main>

    <script>
        // ============================================================
        // CONFIGURATIE
        // ============================================================
        const API_URL = 'https://upc-floppy-crm-singh.trycloudflare.com/api/syntess';

        // Lees parameters uit URL
        function parseUrlParams() {
            let params = new URLSearchParams(window.location.search);
            let kaarttitel = params.get('kaarttitel') || '';
            let cardid = params.get('cardid') || '';

            let klantnummer = '';
            let referentie = '';

            const klantnummerMatch = kaarttitel.match(/klantnummer:\s*(\d+)/i);
            if (klantnummerMatch) {
                klantnummer = klantnummerMatch[1];
            }

            const referentieMatch = kaarttitel.match(/REF(\d+)/i);
            if (referentieMatch) {
                referentie = 'REF' + referentieMatch[1];
            }

            return { klantnummer, referentie, kaarttitel, cardid };
        }

        const { klantnummer, referentie, kaarttitel, cardid } = parseUrlParams();

        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('klantnummer').value = klantnummer;
            document.getElementById('referentie').value = referentie;
            document.getElementById('kaarttitel').value = kaarttitel;
            document.getElementById('cardid').value = cardid;
        });

        // PowerShell output validatie
        document.getElementById('powershell-output').addEventListener('input', function() {
            validatePowerShellOutput(this.value);
        });

        function validatePowerShellOutput(output) {
            const validationDiv = document.getElementById('ps-validation');
            const contentDiv = document.getElementById('ps-validation-content');

            if (!output.trim()) {
                validationDiv.style.display = 'none';
                return;
            }

            const okCount = (output.match(/OK:/g) || []).length;
            const foutCount = (output.match(/FOUT:/g) || []).length;
            const warnCount = (output.match(/WAARSCHUWING:/g) || []).length;

            const isValidOutput = output.includes('SSH Configuratie Test') &&
                                  output.includes('Test voltooid');

            let status = 'success';
            let title = '‚úì PowerShell test geslaagd';

            if (!isValidOutput) {
                status = 'error';
                title = '‚úó Ongeldige output';
            } else if (foutCount > 0) {
                status = 'error';
                title = '‚úó PowerShell test bevat fouten';
            } else if (warnCount > 0) {
                status = 'warning';
                title = '‚ö† PowerShell test bevat waarschuwingen';
            }

            let html = `<h4>${title}</h4>`;

            if (!isValidOutput) {
                html += `<p>Dit lijkt geen geldige PowerShell testoutput te zijn. Kopieer de volledige output van het script.</p>`;
            } else {
                html += `<ul>`;
                html += `<li class="ps-ok">‚úì ${okCount} checks geslaagd</li>`;
                if (foutCount > 0) {
                    html += `<li class="ps-fout">‚úó ${foutCount} fouten gevonden</li>`;
                }
                if (warnCount > 0) {
                    html += `<li class="ps-warn">‚ö† ${warnCount} waarschuwingen</li>`;
                }
                html += `</ul>`;

                if (foutCount > 0) {
                    const fouten = output.match(/FOUT:.*$/gm) || [];
                    html += `<p style="margin-top: 8px;"><strong>Gevonden fouten:</strong></p><ul>`;
                    fouten.forEach(f => {
                        html += `<li class="ps-fout">${f}</li>`;
                    });
                    html += `</ul>`;
                }
            }

            contentDiv.innerHTML = html;
            validationDiv.className = `ps-validation ${status}`;
            validationDiv.style.display = 'block';
        }

        // Toon/verberg intern IP veld bij jump server
        document.getElementById('server-type').addEventListener('change', function() {
            const internIpGroup = document.getElementById('intern-ip-group');
            const internIpInput = document.getElementById('intern-ip');

            if (this.value === 'jumpserver') {
                internIpGroup.classList.add('visible');
                internIpInput.required = true;
            } else {
                internIpGroup.classList.remove('visible');
                internIpInput.required = false;
                internIpInput.value = '';
            }
        });

        // Navigation active state
        document.querySelectorAll('.page-nav a').forEach(link => {
            link.addEventListener('click', function(e) {
                document.querySelectorAll('.page-nav a').forEach(l => l.classList.remove('active'));
                this.classList.add('active');
            });
        });

        // Test functie
        async function runTest() {
            const btnTest = document.getElementById('btn-test');
            const btnSubmit = document.getElementById('btn-submit');
            const resultsDiv = document.getElementById('test-results');
            const itemsDiv = document.getElementById('test-items');
            const testRequiredMsg = document.getElementById('test-required-msg');

            const form = document.getElementById('ssh-config-form');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            const serverType = document.getElementById('server-type').value;
            const externIp = document.getElementById('extern-ip').value;
            const internIp = document.getElementById('intern-ip').value || 'localhost';
            const firebirdPoort = document.getElementById('firebird-poort').value;
            const sshWachtwoord = document.getElementById('ssh-wachtwoord').value;
            const dbGebruiker = document.getElementById('db-gebruiker').value;
            const dbWachtwoord = document.getElementById('db-wachtwoord').value;
            const databasePad = document.getElementById('database-pad').value;

            btnTest.disabled = true;
            btnTest.innerHTML = '<span class="spinner"></span>Testen...';
            btnSubmit.disabled = true;
            resultsDiv.style.display = 'block';

            const tests = [
                { id: 'port', name: 'Poort 49222 bereikbaar', status: 'pending' },
                { id: 'ssh', name: 'SSH login (notifica)', status: 'pending' },
                { id: 'tunnel', name: 'SSH tunnel opzetten', status: 'pending' },
                { id: 'firebird', name: 'Firebird poort via tunnel', status: 'pending' }
            ];

            renderTests(tests);

            try {
                const response = await fetch(`${API_URL}/sshtest`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        extern_ip: externIp,
                        intern_ip: internIp,
                        firebird_poort: parseInt(firebirdPoort),
                        ssh_wachtwoord: sshWachtwoord,
                        db_gebruiker: dbGebruiker,
                        db_wachtwoord: dbWachtwoord,
                        database_pad: databasePad,
                        server_type: serverType
                    })
                });

                const result = await response.json();

                tests[0].status = result.port_reachable ? 'success' : 'error';
                tests[0].detail = result.port_message;

                tests[1].status = result.ssh_login ? 'success' : 'error';
                tests[1].detail = result.ssh_message;

                tests[2].status = result.tunnel_works ? 'success' : 'error';
                tests[2].detail = result.tunnel_message;

                tests[3].status = result.firebird_reachable ? 'success' : 'error';
                tests[3].detail = result.firebird_message;

                renderTests(tests);

                const allPassed = result.port_reachable && result.ssh_login &&
                                  result.tunnel_works && result.firebird_reachable;

                if (allPassed) {
                    btnSubmit.disabled = false;
                    btnSubmit.title = '';
                    testRequiredMsg.innerHTML = '<div class="icon">‚úì</div><div class="text"><strong>Alle tests geslaagd!</strong><p>U kunt nu het formulier versturen.</p></div>';
                    testRequiredMsg.className = 'info-box success-msg';
                } else {
                    btnSubmit.disabled = true;
                    btnSubmit.title = 'Los eerst de fouten op en test opnieuw';
                    testRequiredMsg.innerHTML = '<div class="icon">‚úó</div><div class="text"><strong>Test niet geslaagd.</strong><p>Los de bovenstaande fouten op en test opnieuw.</p></div>';
                    testRequiredMsg.className = 'warning-box';
                }

            } catch (error) {
                console.error('Test error:', error);
                tests.forEach(t => {
                    t.status = 'error';
                    t.detail = 'Kon geen verbinding maken met test-API';
                });
                renderTests(tests);
                testRequiredMsg.innerHTML = '<div class="icon">‚úó</div><div class="text"><strong>Test mislukt.</strong><p>Kon geen verbinding maken met de test-server. Probeer het later opnieuw.</p></div>';
                testRequiredMsg.className = 'warning-box';
            }

            btnTest.disabled = false;
            btnTest.innerHTML = 'üîç Test opnieuw';
        }

        function renderTests(tests) {
            const itemsDiv = document.getElementById('test-items');
            itemsDiv.innerHTML = tests.map(test => `
                <div class="test-item">
                    <div class="test-icon ${test.status}">
                        ${test.status === 'pending' ? '‚óã' :
                          test.status === 'success' ? '‚úì' :
                          test.status === 'warning' ? '‚ö†' : '‚úó'}
                    </div>
                    <div class="test-message">
                        <div>${test.name}</div>
                        ${test.detail ? `<div class="test-detail">${test.detail}</div>` : ''}
                    </div>
                </div>
            `).join('');
        }

        // Formulier versturen
        document.getElementById('ssh-config-form').addEventListener('submit', async function(e) {
            e.preventDefault();

            const btnSubmit = document.getElementById('btn-submit');
            btnSubmit.disabled = true;
            btnSubmit.innerHTML = '<span class="spinner"></span>Versturen...';

            const formData = new FormData(this);

            const data = {
                datum: new Date().toISOString(),
                klantnummer: document.getElementById('klantnummer').value,
                referentie: document.getElementById('referentie').value,
                kaarttitel: document.getElementById('kaarttitel').value,
                cardid: document.getElementById('cardid').value,
                klantnaam: formData.get('klantnaam'),
                bedrijfsnaam: formData.get('bedrijfsnaam'),
                contactpersoon: formData.get('contactpersoon'),
                email: formData.get('email'),
                telefoon: formData.get('telefoon'),
                'server-type': formData.get('server-type'),
                'extern-ip': formData.get('extern-ip'),
                'intern-ip': formData.get('intern-ip') || 'localhost',
                'firebird-poort': formData.get('firebird-poort'),
                'database-pad': formData.get('database-pad'),
                'ssh-wachtwoord': formData.get('ssh-wachtwoord'),
                'db-gebruiker': formData.get('db-gebruiker'),
                'db-wachtwoord': formData.get('db-wachtwoord'),
                'powershell-output': formData.get('powershell-output')
            };

            try {
                const response = await fetch('https://prod-204.westeurope.logic.azure.com:443/workflows/d0e099be0461471299bf95f18afd5c23/triggers/When_an_HTTP_request_is_received/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2FWhen_an_HTTP_request_is_received%2Frun&sv=1.0&sig=UQwGZbPKxjvGN61WO2YRMFa5zHLmqH0xIadDiS75JcU', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });

                if (response.ok || response.status === 202) {
                    alert('Formulier succesvol verzonden!\n\nWij gaan de verbinding controleren en nemen contact op bij vragen.');
                } else {
                    alert('Er ging iets mis bij het verzenden.\n\nProbeer het opnieuw of neem contact op met Notifica.');
                }
            } catch (error) {
                console.error('Submit error:', error);
                alert('Kon formulier niet versturen.\n\nControleer uw internetverbinding en probeer het opnieuw.');
            }

            btnSubmit.disabled = false;
            btnSubmit.innerHTML = 'üì§ Verstuur formulier';
        });
    </script>
</body>
</html>
